<div class="flex items-center justify-center min-h-screen py-8">
  <div class="w-full max-w-md px-4">
    <div class="text-center mb-6">
      <a routerLink="/" class="text-2xl font-bold">
        MyShop
      </a>
    </div>

    <z-card class="w-full" zTitle="Reset Password" [zDescription]="'Enter the verification code sent to ' + email + ' and your new password.'">
      <div class="space-y-4">
        <fieldset [disabled]="isLoading()">
          <form class="flex flex-col gap-4" [formGroup]="resetForm" (ngSubmit)="onSubmit()">
            <z-form-field>
              <label z-form-label zRequired>Verification Code</label>
              <z-form-control>
                <input
                  z-input
                  type="text"
                  id="code"
                  formControlName="code"
                  placeholder="Enter 6-digit code"
                  maxlength="6"
                  class="text-center text-lg tracking-widest"
                >
              </z-form-control>
              @if (resetForm.get('code')?.touched && resetForm.get('code')?.invalid) {
                <z-form-message zType="error">
                  @if (resetForm.get('code')?.errors?.['required']) {
                    Verification code is required
                  }
                  @if (resetForm.get('code')?.errors?.['pattern']) {
                    Code must be 6 digits
                  }
                </z-form-message>
              }
            </z-form-field>

            <z-form-field>
              <label z-form-label zRequired>New Password</label>
              <z-form-control>
                <input
                  z-input
                  [type]="showPassword ? 'text' : 'password'"
                  id="password"
                  formControlName="password"
                  placeholder="Enter new password"
                >
              </z-form-control>
              @if (resetForm.get('password')?.touched && resetForm.get('password')?.invalid) {
                <z-form-message zType="error">
                  @if (resetForm.get('password')?.errors?.['required']) {
                    Password is required
                  }
                  @if (resetForm.get('password')?.errors?.['minlength']) {
                    Password must be at least 8 characters
                  }
                </z-form-message>
              }
            </z-form-field>

            <z-form-field>
              <label z-form-label zRequired>Confirm Password</label>
              <z-form-control>
                <input
                  z-input
                  [type]="showConfirmPassword ? 'text' : 'password'"
                  id="password_confirmation"
                  formControlName="password_confirmation"
                  placeholder="Confirm new password"
                >
              </z-form-control>
              @if (resetForm.get('password_confirmation')?.touched && resetForm.get('password_confirmation')?.invalid) {
                <z-form-message zType="error">
                  Please confirm your password
                </z-form-message>
              }
              @if (resetForm.errors?.['passwordMismatch'] && resetForm.get('password_confirmation')?.touched) {
                <z-form-message zType="error">
                  Passwords do not match
                </z-form-message>
              }
            </z-form-field>

            <button z-button zType="default" type="submit" [disabled]="resetForm.invalid || isLoading()" class="w-full cursor-pointer mt-5">
              @if (isLoading()) {
                <span>Resetting...</span>
              } @else {
                <span>Reset Password</span>
              }
            </button>
          </form>
        </fieldset>

        <div class="text-center pt-2 border-t">
          <button z-button zType="link" routerLink="/auth/login" class="cursor-pointer text-xs">‚Üê Back to Login</button>
        </div>
      </div>
    </z-card>
  </div>
</div>

